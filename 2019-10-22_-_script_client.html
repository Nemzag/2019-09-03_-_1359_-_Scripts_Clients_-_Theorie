<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>

<main>

    <section id="section-principal">

      <section>
        <fieldset>
          <h3>2019‑10‑22 ‒ 09H55</h3>

          <pre><code class="language-html line-numbers">&lt;!-- H.T.M.‑L. --&gt;
&lt;table&gt;
	&lt;tbody id="tbody"&gt;
		&lt;tr&gt;
			&lt;td&gt;Dubois&lt;/td&gt;
			&lt;td&gt;Louis&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;</code></pre>

          <pre><code class="language-javascript line-numbers">/* JavaScript */

// Construction de ligne.
let $tr = document.createElement("tr");

// Construit la cellule
let $tdNom = document.createElement("td");
$tdNom.innerHTML = pers.nom;

// Construit la seconde cellule
$let $tdPrenom = document.createElement("td");
$tdPrenom.innerHTML = pers.prenom;

// Ajoute les cellules dans la ligne
$tr.appendChild($tdNom);
$tr.appendChild($tdprenom);

// Ajoute la ligne à la suite du tbody
document.getElementById("tbody").appendChild($tr);</code></pre>

          <br>

          <p>.lastChild est plus lourd, le prof prefere utilisé un pointeur.</p>

          <h4>ex2019_14.js</h4>

          <p>ligne 25 : `nom: ${user.nom}` </p>

          <p>Trier deux elements, 25 < 32,<br> dans beaucoupd elanugage on aprt du princiepe que ABC est plush pette que XYZ,<br> en
            <abbr title="American Standard Code for Information Interchange">A.S.C.I.I.</abbr>,<br> par contre en javascript, comme on utilise du J.S.O.N. on doit employé localCompare (ligne 17).
          </p>

          <p>${} : « multi‑line stri‑ng’s inter‑pola‑tion » en
            <abbr title="Personal Home Page / PHP : Hypertext Preprocessor">P.H.P.</abbr>, on peut utiliser directement des variables,<br> il ont décidé qeue le backquote sont l'affichage, et si on veut appeller la variable,<br> on doit employé ${} dans ce cas ${user.name}…
          </p>

          listPays.php ligne 11 :
        </fieldset>
      </section>

      <section>
        <fieldset>
          <h3>2019‑10‑22 ‒ 11H25 ‒ Ex2019_15&nbsp;:</h3>

          <ul>
            <li>filter [BE]<br> ↓<br> Belgique,<br> benin.</li>
            <li>Ajoute checkbox</li>
            <li>➡️<br> Copier uniquement les elements cochés.</li>
          </ul>

          <pre><code class="language-php line-numbers">&lt;?php
  $idP= $_GET['idPays'];
  $pdo=new PDO('mysql:host=localhost; dbname=paysmonde; charset=utf8',
               'root', '');

  $statement=$pdo->prepare("SELECT * FROM pays WHERE idP = :idP");
  $statement->execute([':idP'=>$idP]);
  $results=$statement->fetchAll(PDO::FETCH_ASSOC);
  $json=json_encode($results);

  echo $json;
?></code></pre>

          <pre><code class="language-php line-numbers">&lt;?php
  $filtre= $_GET['filtrePays'];
  $pdo=new PDO('mysql:host=localhost; dbname=paysmonde; charset=utf8',
               'root', '');

  $statement=$pdo->prepare(
      "(SELECT idP, nomFrP
          FROM pays
         WHERE nomFrP
          LIKE :filtre1
      ORDER BY nomFrP ASC;)"
      ." UNION "
     ."(SELECT idP, nomFrP
          FROM pays
         WHERE nomFrP
          LIKE :filtre2
      ORDER BY nomFrP ASC)"
     );
  $statement->execute([':filtre1'=>$filtre.'%', /* chaîne + % = tout. */
                       ':filtre2'=>'%'.$filtre.'%']);
  $results=$statement->fetchAll(PDO::FETCH_ASSOC);
  $json=json_encode($results);

  echo $json;
?></code></pre>

          <h4>H.T.M.‑L. :</h4>
          <pre><code class="language-html line-numbers">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
	&lt;head&gt;
		&lt;meta charset="UTF-8" /&gt;
		&lt;title&gt;AJAX : liste des utilisateurs&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;input type="text" id="txtFiltreNom" /&gt;
		&lt;br /&gt;
		&lt;div id="divUsers"&gt;&lt;/div&gt;

		&lt;script src="ex2019_14.js"&gt;&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>

          <pre><code class="language-javascript line-numbers">// ============================================================
const TEXTE_PAYS = document.getElementById("Ex2019_15TxtPays");
const DIV_LISTE_PAYS = document.getElementById("Ex2019_15DivListePays");

TEXTE_PAYS.addEventListener("input", afficheListePays);

// ============================================================

function afficheListePays() {
//console.log("Liste des pays");
let $filtrePays = TEXTE_PAYS.value.trim();
console.log("filtrePays :" + $filtrePays);

// IL faut absoulement inseré le parametre.
fetch("./prof/ex2019_15/listePays.php?filtrePays=" + $filtrePays)
/*
    // Quand l'info reviendra :
    .then(reponse => {
        console.log("réponse :", reponse);
    });
    */
// Transformation en format JSON
    .then($reponse => $reponse.json())
    .then($listePays => {
        // console.log("listePays :", $listePays);
        DIV_LISTE_PAYS.innerHTML = "";
        for (const PAYS of $listePays) {
            // console.log("pays :", pays);
            // console.log("pays.nomFrP :", pays.nomFrP);
            let $paragraphPays = document.createElement("span");
            $paragraphPays.innerHTML = PAYS.nomFrP + "<br/>";

            DIV_LISTE_PAYS.appendChild($paragraphPays);
        }
    });
};</code></pre>

          <div>
            <label for="Ex2019_15TxtPays">Pays</label> <input type="text" id="Ex2019_15TxtPays">
            <input type="text" value="⇒" id="Ex2019_15Btn">
          </div>

          <div id="Ex2019_15DivListePays"></div>
          <div id="Ex2019_15DivPaysSelect"></div>

          <script>
            "use strict";

              // ============================================================
              const TEXTE_PAYS = document.getElementById("Ex2019_15TxtPays");
              const DIV_LISTE_PAYS = document.getElementById("Ex2019_15DivListePays");

              TEXTE_PAYS.addEventListener("input", afficheListePays);

              // ============================================================

              function afficheListePays() {
                  //console.log("Liste des pays");
                  let $filtrePays = TEXTE_PAYS.value.trim();
                  console.log("filtrePays :" + $filtrePays);

                  // IL faut absoulement inseré le parametre.
                  fetch("./prof/ex2019_15/listePays.php?filtrePays=" + $filtrePays)
                  /*
                      // Quand l'info reviendra :
                      .then(reponse => {
                          console.log("réponse :", reponse);
                      });
                      */
                  // Transformation en format JSON
                      .then($reponse => $reponse.json())
                      .then($listePays => {
                          // console.log("listePays :", $listePays);
                          DIV_LISTE_PAYS.innerHTML = "";
                          for (const PAYS of $listePays) {
                              // console.log("pays :", pays);
                              // console.log("pays.nomFrP :", pays.nomFrP);
                              let $paragraphPays = document.createElement("span");
                              $paragraphPays.innerHTML = PAYS.nomFrP + "<br />";

                              DIV_LISTE_PAYS.appendChild($paragraphPays);

                              // Chk = checkbox
                          }
                      });
              };
          </script>

        </fieldset>
      </section>

    </section>
    <!-- END PRINCIPAL CONTENT -->

  </article>

</main>